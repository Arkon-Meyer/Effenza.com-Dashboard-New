name: Secret scan
on: [push, pull_request]
jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: grep for common secrets
        run: |
          ! git grep -nE "ghp_[A-Za-z0-9]{36,}|_authToken|npm\.pkg\.github\.com|GHCR_TOKEN|NPM_TOKEN|GITHUB_TOKEN" -- ':!node_modules'
